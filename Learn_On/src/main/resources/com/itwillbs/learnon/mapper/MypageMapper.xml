<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwillbs.learnon.mapper.MypageMapper">
	<select id="selectWishlist" resultType="wish">
		-- 관심목록 조회
		SELECT A.WISHLIST_IDX
			 , A.MEM_ID
			 , A.CLASS_ID
			 , B.CLASS_CATEGORY
			 , B.CLASS_TITLE
		     , B.CLASS_REG_DATE
		     , (SELECT TRUNCATE(AVG(REVIEW_SCORE), 1)
				FROM REVIEW
				WHERE CLASS_ID = A.CLASS_ID) AS REVIEW_SCORE
			 , C.MEM_NAME AS TEACHER_NAME
		  FROM WISHLIST A 
		  JOIN CLASS B
			ON A.CLASS_ID = B.CLASS_ID
		  JOIN MEMBER C
			ON B.MEM_ID = C.MEM_ID
		 WHERE A.MEM_ID = #{id}
		 <choose>
		 	<when test="filterType.equals('newest')">
				ORDER BY B.CLASS_REG_DATE DESC
		 	</when>
		 	<when test="filterType.equals('popularity')">
				ORDER BY REVIEW_SCORE DESC
		 	</when>
		 </choose>
	</select>
</mapper>